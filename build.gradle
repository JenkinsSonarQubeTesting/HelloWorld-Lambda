plugins {
    id 'java'
}

group 'com.cdalymac.testproject'
version '1.0-SNAPSHOT'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
}

wrapper {
    gradleVersion = '4.8'
}

task deployTerraform (type: Exec){
    environment "PATH", "${environment.PATH}"
    commandLine "echo", "Path: ${environment.PATH}"
    if (project.hasProperty('USER_ID')){
        commandLine "terraform", "init"
        if (project.hasProperty('USER_ID')){
            echo 'User ID found'
        }
        userId = project.findProperty('USER_ID') ?: ''
        roleName = project.findProperty('ROLE_NAME') ?: ''
        commandLine "terraform", "apply",  "-var 'aws_user_ID=${userId}'", "-var 'role_name=${roleName}'", "-var 'region=us-east-1'", "-input=false",  "-auto-approve"
    }
}
